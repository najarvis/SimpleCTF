[gd_scene load_steps=4 format=2]

[ext_resource path="res://Noise.png" type="Texture" id=1]

[sub_resource type="Shader" id=1]

code = "shader_type canvas_item;


//uniform float offset_mul = 1.0;

uniform vec4 water_color : hint_color;
uniform vec4 sand_color : hint_color;
uniform vec4 grass_color : hint_color;
uniform vec4 stone_color : hint_color;

float fixed_sin(float t) {
	return (sin(t) + 1.0) / 2.0;	
}

float fixed_cos(float t) {
	return (cos(t) + 1.0) / 2.0;	
}

void fragment() {
	float offset_mul = sin(TIME) * 0.1;
	float offset = texture(TEXTURE, UV).r * offset_mul - (offset_mul / 2.0);
	vec2 new = mod(UV + vec2(offset), vec2(1.0));
	float height = texture(TEXTURE, new).r;
	
	if (height < 0.4) {
		COLOR = water_color * (height + 0.6);
	}
	else if (height < 0.43) {
		COLOR = sand_color * (height + 0.57);	
	}
	else if (height < 0.7) {
		COLOR = grass_color * (height + 0.3);	
	}
	else if (height < 0.85) {
		COLOR = stone_color * (height + 0.15);	
	}
	else {
		COLOR.rgb = vec3(height);	
	}
	if (texture(TEXTURE, new-(vec2(0.0, 0.03))).r > height) {
		COLOR.rgb *= 0.45;	
	}
}"

[sub_resource type="ShaderMaterial" id=2]

render_priority = 0
shader = SubResource( 1 )
shader_param/water_color = Color( 0.136292, 0.28507, 0.792969, 1 )
shader_param/sand_color = Color( 0.898438, 0.869484, 0.561523, 1 )
shader_param/grass_color = Color( 0.199115, 0.390625, 0.102234, 1 )
shader_param/stone_color = Color( 0.253906, 0.19793, 0.170593, 1 )
_sections_unfolded = [ "shader_param" ]

[node name="Node2D" type="Node2D" index="0"]

[node name="Noise2" type="Sprite" parent="." index="0"]

position = Vector2( 595.076, 2.29215 )
texture = ExtResource( 1 )

[node name="Noise" type="Sprite" parent="." index="1"]

material = SubResource( 2 )
position = Vector2( 1.00465, -2.32654 )
texture = ExtResource( 1 )
_sections_unfolded = [ "Material" ]

[node name="Camera2D" type="Camera2D" parent="." index="2"]

anchor_mode = 1
rotating = false
current = true
zoom = Vector2( 1, 1 )
limit_left = -10000000
limit_top = -10000000
limit_right = 10000000
limit_bottom = 10000000
limit_smoothed = false
drag_margin_h_enabled = true
drag_margin_v_enabled = true
smoothing_enabled = false
smoothing_speed = 5.0
offset_v = 0.0
offset_h = 0.0
drag_margin_left = 0.2
drag_margin_top = 0.2
drag_margin_right = 0.2
drag_margin_bottom = 0.2
editor_draw_screen = true
editor_draw_limits = false
editor_draw_drag_margin = false


